<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        #board-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            position: relative;
        }
        #board {
            display: grid;
            grid-template-columns: repeat(9, 60px);
            grid-template-rows: repeat(12, 60px);
            gap: 2px;
            border: 5px solid #333;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            background-color: #fafafa;
            position: relative;
        }
        .cell {
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #e0e0e0;
            border-radius: 5px;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }
        .player {
            position: absolute;
            width: 30px;
            height: 30px;
            border: 2px solid black;
            box-sizing: border-box;
            border-radius: 50%;
        }
        #player1 { background-color: rgba(255, 0, 0, 0.8); }
        #player2 { background-color: rgba(0, 0, 255, 0.8); }
        #player3 { background-color: rgba(0, 255, 0, 0.8); }
        #player4 { background-color: rgba(255, 255, 0, 0.8); }
        #player5 { background-color: rgba(255, 0, 255, 0.8); }
        #player6 { background-color: rgba(0, 255, 255, 0.8); }
        #debug {
            display: none;
            margin-top: 20px;
            border: 1px solid black;
            padding: 10px;
            text-align: left;
            width: 80%;
            margin: 20px auto;
        }
    </style>
</head>
<body>
    <h3>Welcome to Slippers Slopes and Leaders Ladder game!</h3>
    <p>1. Landscape mode is better 2. Select: 
    <select id="playerCount">
        <option value="2">2 Players</option>
        <option value="3">3 Players</option>
        <option value="4">4 Players</option>
        <option value="5">5 Players</option>
        <option value="6">6 Players</option>
    </select>
    <button id="startGame">3. Start</button>
    <button id="rollDice" disabled>Roll Dice</button>
    </p>
    <button id="toggleDebug">Toggle Debug</button>
    <p></p>
    <div id="board-container">
        <div id="board"></div>
    </div>
    <div id="debug"></div>

    <script>
        function rollDice() {
            return Math.floor(Math.random() * 6) + 1;
        }
        function rollDiceForLadderRead() {
            return Math.floor(Math.random() * 3) + 1;
        }
        function rollDiceForSlopeRead() {
            return Math.floor(Math.random() * 2) + 1;
        }

        function isPrime(number) {
            if (number <= 1) return false;
            if (number <= 3) return true;
            if (number % 2 === 0 || number % 3 === 0) return false;
            let i = 5;
            while (i * i <= number) {
                if (number % i === 0 || number % (i + 2) === 0) return false;
                i += 6;
            }
            return true;
        }

        function getNextPrime(number) {
            let next = number + 1;
            while (!isPrime(next)) {
                next++;
            }
            return next;
        }

        function getPreviousPrime(number) {
            let prev = number - 1;
            while (!isPrime(prev)) {
                prev--;
            }
            return prev;
        }

        function movePlayer(player, diceValue) {
            let oldPosition = player.position;
            let newPosition = player.position - diceValue;
            let message = "";
            let popUpContent = "";

            if (newPosition >= 0) {
                player.position = newPosition;

                if (isPrime(newPosition + 1) && newPosition + 1 >= 54) {
                    const previousPrime = getPreviousPrime(newPosition + 1);
                    player.position = previousPrime - 1;
                    message = `Player landed on Slippery Slope, moved to one prime backward ${108 - previousPrime}`;
                    popUpContent = slopeText[rollDiceForSlopeRead() - 1];
                } else if (isPrime(newPosition + 1)) {
                    const nextPrime = getNextPrime(newPosition + 1);
                    player.position = nextPrime - 1;
                    message = `Player landed on Leader's Ladder, moved to next prime ${108 - nextPrime}`;
                    popUpContent = ladderText[rollDiceForLadderRead() - 1];
                }

                return { oldPosition, newPosition: player.position, message, popUpContent };
            }
            return null;
        }

        function updatePlayerPosition(player) {
            const [row, column] = getPositionFromIndex(player.position);
            const playerElement = document.getElementById(`player${player.id}`);
            playerElement.style.transform = `translate(${column * 60}px, ${row * 60}px)`;
        }

        function updateDebugInfo(moveResult, diceValue) {
            if (moveResult) {
                const debugElement = document.getElementById('debug');
                const { oldPosition, newPosition, message } = moveResult;
                const [oldRow, oldColumn] = getPositionFromIndex(oldPosition);
                const [newRow, newColumn] = getPositionFromIndex(newPosition);
                debugElement.innerHTML = `
                    <p><strong>Dice Rolled:</strong> ${diceValue}</p>
                    <p><strong>Old Position:</strong> Row ${oldRow}, Column ${oldColumn}</p>
                    <p><strong>New Position:</strong> Row ${newRow}, Column ${newColumn}</p>
                    ${message ? `<p><strong>Message:</strong> ${message}</p>` : ''}
                `;
            }
        }

        function getPositionFromIndex(index) {
            const row = Math.floor(index / 9);
            let column = index % 9;
            if (row % 2 === 1) {
                column = 8 - column;
            }
            return [row, column];
        }

        const ladderText = [
            "Matsya Avtaar, 1 of 5: When the universe was going to be submerged in the biggest of all rains, Lord Vishnu appeared as a humongous fish, Matsya.",
            "Matsya Avtaar, 2 of 5: During the greate universal deluge, Matsya rescued all forms of life that would listen to his plan and once the rains were gone, he gave them a brand new world.",
            "Matsya Avtaar, 3 of 5: To safe the world, Matsya asked Satyavrata to join his team. Satyavrata built a huge ship and got all the living things onto the ship and the ship was rescued by Matsya during the universal deluge."
        ];
        const slopeText = [
            "Matsya Avtaar, 4 of 5: While Satyavrata and Matsya were plaing to save life during the great univeral deluge, Hayagrivah was busy stealing all the knowledge.",
            "Matsya Avtaar, 5 of 5: While the universal life resuce opetion was under way, Vishnu saw Satyavrata stealing knowledge and asked him repeatedly to give the knowledge back to the world, when he refused, Vishnu Matsya vanquished him, and gave the knowledge back to the world full of new life."
        ];

        const board = [];
        const players = [];
        let currentPlayerIndex = 0;
        let gameStarted = false;

        document.getElementById('startGame').addEventListener('click', () => {
            const playerCount = parseInt(document.getElementById('playerCount').value);
            for (let i = 0; i < playerCount; i++) {
                players.push({ id: i + 1, position: 107 });
                const playerElement = document.createElement('div');
                playerElement.id = `player${i + 1}`;
                playerElement.classList.add('player');
                document.getElementById('board').appendChild(playerElement);
                updatePlayerPosition(players[i]);
            }
            document.getElementById('rollDice').disabled = false;
            gameStarted = true;
        });

        document.getElementById('rollDice').addEventListener('click', () => {
            if (!gameStarted) return;
            const diceValue = rollDice();
            const player = players[currentPlayerIndex];
            const moveResult = movePlayer(player, diceValue);
            if (moveResult) {
                updatePlayerPosition(player);
                updateDebugInfo(moveResult, diceValue);
                if (moveResult.popUpContent) {
                    alert(moveResult.popUpContent);
                }
            }
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
        });

        document.getElementById('toggleDebug').addEventListener('click', () => {
            const debugElement = document.getElementById('debug');
            if (debugElement.style.display === 'none') {
                debugElement.style.display = 'block';
            } else {
                debugElement.style.display = 'none';
            }
        });

        // Initialize the board
        const boardElement = document.getElementById('board');
        for (let i = 0; i < 108; i++) {
            const cell = document.createElement('div');
            cell.classList.add('cell');
            cell.innerText = 108 - i;
            boardElement.appendChild(cell);
        }
    </script>
</body>
</html>
